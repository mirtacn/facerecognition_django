{% load static %}
<div class="container-fluid">
    <!-- Foto Wajah - SEMUA FOTO -->
    <div class="row mb-4">
        <div class="col-12">
            <h6 class="text-primary mb-3 fw-bold">Foto Wajah <span class="badge bg-primary rounded-pill">{{ foto_wajah|length }} foto</span></h6>
            
            <div class="row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-5 g-3 mb-4">
                {% for foto in foto_wajah %}
                <div class="col">
                    <div class="card border h-100 shadow-sm">
                        <div class="card-body p-2 text-center d-flex flex-column">
                            {% if foto.file_path %}
                            <img src="{{ foto.file_path.url }}" alt="Foto {{ forloop.counter }}" 
                                 class="img-fluid rounded mb-2 flex-grow-1 object-fit-cover"
                                 style="height: 120px; width: 100%;"
                                 onerror="this.onerror=null;">
                            {% else %}
                            <div class="bg-light rounded d-flex align-items-center justify-content-center mb-2 flex-grow-1" 
                                 style="height: 120px;">
                                <i class="fas fa-image text-muted fa-2x"></i>
                            </div>
                            {% endif %}
                            <small class="text-muted">Foto {{ forloop.counter }}</small>
                            {% if foto.created_at %}
                            <small class="text-muted">{{ foto.created_at|date:"d/m/Y" }}</small>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="col-12">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Tidak ada foto wajah yang diupload
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <div class="d-flex justify-content-between align-items-center mb-4">
                <button type="button" 
                        class="btn btn-primary btn-download-modal"
                        data-mahasiswa-id="{{ mahasiswa.id }}"
                        data-nama="{{ mahasiswa.user.nama_lengkap }}"
                        data-nrp="{{ mahasiswa.user.nrp }}">
                    <i class="fas fa-download me-2"></i> Download Semua Foto (ZIP)
                </button>
                <small class="text-muted">Total {{ foto_wajah|length }} foto ditemukan</small>
            </div>
        </div>
    </div>
    
    <hr class="my-4">
    
    <!-- Informasi Mahasiswa -->
    <div class="row mb-4">
        <div class="col-12">
            <h6 class="text-primary mb-3 fw-bold">Informasi Mahasiswa</h6>
        </div>
        
        <div class="col-md-6 mb-3">
            <div class="card border shadow-sm">
                <div class="card-body">
                    <table class="table table-sm table-borderless mb-0">
                        <tbody>
                            <tr>
                                <th style="width: 40%;" class="text-muted">Nama Lengkap</th>
                                <td><strong>{{ mahasiswa.user.nama_lengkap }}</strong></td>
                            </tr>
                            <tr>
                                <th class="text-muted">NRP</th>
                                <td><code class="bg-light p-2 rounded">{{ mahasiswa.user.nrp }}</code></td>
                            </tr>
                            <tr>
                                <th class="text-muted">Email</th>
                                <td>{{ mahasiswa.user.email }}</td>
                            </tr>
                            <tr>
                                <th class="text-muted">Tanggal Daftar</th>
                                <td>{{ mahasiswa.user.date_joined|date:"d M Y H:i" }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="col-md-6 mb-3">
            <div class="card border shadow-sm">
                <div class="card-body">
                    <table class="table table-sm table-borderless mb-0">
                        <tbody>
                            <tr>
                                <th style="width: 40%;" class="text-muted">Jenjang</th>
                                <td>
                                    {% if mahasiswa.jenjang_pendidikan %}
                                    <span class="badge bg-secondary">{{ mahasiswa.jenjang_pendidikan.nama_jenjang }}</span>
                                    {% else %}
                                    <span class="text-muted">-</span>
                                    {% endif %}
                                </td>
                            </tr>
                            <tr>
                                <th class="text-muted">Semester</th>
                                <td>
                                    {% if mahasiswa.semester %}
                                    {{ mahasiswa.semester.nama_semester }}
                                    {% else %}
                                    <span class="text-muted">-</span>
                                    {% endif %}
                                </td>
                            </tr>
                            <tr>
                                <th class="text-muted">Angkatan</th>
                                <td>{{ mahasiswa.angkatan|default:"-" }}</td>
                            </tr>
                            <tr>
                                <th class="text-muted">Kelas</th>
                                <td>{{ mahasiswa.kelas|default:"-" }}</td>
                            </tr>
                            <tr>
                                <th class="text-muted">Jurusan/Prodi</th>
                                <td>
                                    {% if mahasiswa.jurusan %}
                                    <span class="badge bg-info">{{ mahasiswa.jurusan }}</span>
                                    {% else %}
                                    <span class="text-muted">-</span>
                                    {% endif %}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Dosen Pembimbing (Semua: 1, 2, 3) -->
    <div class="row mb-4">
        <div class="col-12">
            <h6 class="text-primary mb-3 fw-bold">Dosen Pembimbing</h6>
        </div>
        
        {% if dosen_pembimbing_list %}
        {% for pembimbing in dosen_pembimbing_list %}
        <div class="col-md-4 mb-3">
            <div class="card border shadow-sm h-100">
                <div class="card-body">
                    <h6 class="card-title text-primary fw-bold">
                        {{ pembimbing.get_tipe_pembimbing_display }}
                    </h6>
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="avatar-lg rounded-circle bg-primary bg-opacity-10 d-flex align-items-center justify-content-center">
                                <i class="fas fa-user-graduate text-primary fs-4"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1 fw-bold">{{ pembimbing.dosen.nama_dosen }}</h6>
                            <p class="text-muted mb-1 small">
                                <i class="fas fa-id-card me-1"></i> NIP: {{ pembimbing.dosen.nip }}
                            </p>
                            <p class="text-muted mb-0 small">
                                <i class="fas fa-building me-1"></i> {{ pembimbing.dosen.prodi }}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div class="col-12">
            <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle"></i> Belum ada dosen pembimbing yang ditetapkan
            </div>
        </div>
        {% endif %}
    </div>
    
    <!-- Mata Kuliah Lab -->
    <div class="row">
        <div class="col-12">
            <h6 class="text-primary mb-3 fw-bold">Mata Kuliah Lab</h6>
        </div>
        
        {% if kegiatan_pa_list %}
        <div class="col-12">
            <div class="row row-cols-1 row-cols-md-2 g-3">
                {% for kegiatan in kegiatan_pa_list %}
                <div class="col">
                    <div class="card border shadow-sm h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h6 class="mb-0 fw-bold">{{ kegiatan.nama_kegiatan }}</h6>
                                <span class="badge bg-primary">{{ kegiatan.jumlah_sks }} SKS</span>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <small class="text-muted d-block">Target Jam</small>
                                    <span class="fw-bold">{{ kegiatan.target_jam }} jam</span>
                                </div>
                                <div class="col-6">
                                    <small class="text-muted d-block">Jam/Minggu</small>
                                    <span class="fw-bold">{{ kegiatan.total_jam_minggu }} jam</span>
                                </div>
                            </div>
                            <div class="mt-3">
                                <small class="text-muted">Tahun Ajaran:</small>
                                <div class="fw-bold">{{ kegiatan.tahun_ajaran.nama_tahun_ajaran }}</div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% else %}
        <div class="col-12">
            <div class="alert alert-info">
                <i class="fas fa-info-circle"></i> Belum ada mata kuliah lab yang ditetapkan
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
// Script untuk modal detail (akan dieksekusi setelah konten dimuat)
document.addEventListener('DOMContentLoaded', function() {
    // Event listener untuk tombol download di modal sudah ditangani di parent
    // Tidak perlu script tambahan karena sudah menggunakan event delegation
});
</script>